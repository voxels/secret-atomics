(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(c){if(c.ep)return;c.ep=!0;const o=t(c);fetch(c.href,o)}})();const F="modulepreload",D=function(d){return"/dolores/"+d},B={},U=function(e,t,n){let c=Promise.resolve();if(t&&t.length>0){let y=function(v){return Promise.all(v.map(w=>Promise.resolve(w).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};var l=y;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),h=f?.nonce||f?.getAttribute("nonce");c=y(t.map(v=>{if(v=D(v),v in B)return;B[v]=!0;const w=v.endsWith(".css"),b=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${b}`))return;const m=document.createElement("link");if(m.rel=w?"stylesheet":F,w||(m.as="script"),m.crossOrigin="",m.href=v,h&&m.setAttribute("nonce",h),document.head.appendChild(m),w)return new Promise((k,E)=>{m.addEventListener("load",k),m.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${v}`)))})}))}function o(f){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=f,window.dispatchEvent(h),!h.defaultPrevented)throw f}return c.then(f=>{for(const h of f||[])h.status==="rejected"&&o(h.reason);return e().catch(o)})};function M(){throw new Error("Buffer is not included.")}M.isBuffer=function(){return!1};var G=50;const z=Object.freeze(Object.defineProperty({__proto__:null,Buffer:M,INSPECT_MAX_BYTES:G,SlowBuffer:M},Symbol.toStringTag,{value:"Module"})),V={};function L(){}function H(){for(var d=arguments.length,e=new Array(d),t=0;t<d;t++)e[t]=arguments[t];var n=e[0];e.shift(),setTimeout(function(){typeof n=="function"&&n.apply(null,e)},0)}function q(d){throw new Error("No such module. (Possibly not yet loaded)")}var K={},T="browser",W=1,J=!0,Y={},X=[],$="/";function Q(){return $}function Z(d){$=V.resolve(d,$)}const ee=Object.freeze(Object.defineProperty({__proto__:null,arch:T,argv:X,binding:q,browser:J,chdir:Z,cwd:Q,dlopen:L,env:Y,execPath:T,exit:L,features:K,kill:L,memoryUsage:L,nextTick:H,pid:W,platform:T,title:T,umask:L,uptime:L,uvCounters:L},Symbol.toStringTag,{value:"Module"}));globalThis.Buffer=M||void 0||z;globalThis.process=ee;class te{products=new Map;constructor(e=[]){e.forEach(t=>this.products.set(t.id,t))}getProducts(){return Array.from(this.products.values())}getProduct(e){return this.products.get(e)}purchase(e){const t=this.products.get(e);return t?t.sold_out||t.stock<=0?{success:!1,reason:"Sold out"}:(t.stock-=1,t.stock===0&&(t.sold_out=!0),{success:!0}):{success:!1,reason:"Product not found"}}updateStock(e,t){const n=this.products.get(e);n&&(n.stock=t,n.sold_out=t<=0)}}var P={exports:{}},j;function ne(){if(j)return P.exports;j=1;var d=typeof Reflect=="object"?Reflect:null,e=d&&typeof d.apply=="function"?d.apply:function(r,i,a){return Function.prototype.apply.call(r,i,a)},t;d&&typeof d.ownKeys=="function"?t=d.ownKeys:Object.getOwnPropertySymbols?t=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:t=function(r){return Object.getOwnPropertyNames(r)};function n(s){console&&console.warn&&console.warn(s)}var c=Number.isNaN||function(r){return r!==r};function o(){o.init.call(this)}P.exports=o,P.exports.once=S,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var l=10;function f(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(s){if(typeof s!="number"||s<0||c(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");l=s}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||c(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function h(s){return s._maxListeners===void 0?o.defaultMaxListeners:s._maxListeners}o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(r){for(var i=[],a=1;a<arguments.length;a++)i.push(arguments[a]);var u=r==="error",g=this._events;if(g!==void 0)u=u&&g.error===void 0;else if(!u)return!1;if(u){var p;if(i.length>0&&(p=i[0]),p instanceof Error)throw p;var _=new Error("Unhandled error."+(p?" ("+p.message+")":""));throw _.context=p,_}var C=g[r];if(C===void 0)return!1;if(typeof C=="function")e(C,this,i);else for(var R=C.length,N=k(C,R),a=0;a<R;++a)e(N[a],this,i);return!0};function y(s,r,i,a){var u,g,p;if(f(i),g=s._events,g===void 0?(g=s._events=Object.create(null),s._eventsCount=0):(g.newListener!==void 0&&(s.emit("newListener",r,i.listener?i.listener:i),g=s._events),p=g[r]),p===void 0)p=g[r]=i,++s._eventsCount;else if(typeof p=="function"?p=g[r]=a?[i,p]:[p,i]:a?p.unshift(i):p.push(i),u=h(s),u>0&&p.length>u&&!p.warned){p.warned=!0;var _=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");_.name="MaxListenersExceededWarning",_.emitter=s,_.type=r,_.count=p.length,n(_)}return s}o.prototype.addListener=function(r,i){return y(this,r,i,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(r,i){return y(this,r,i,!0)};function v(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(s,r,i){var a={fired:!1,wrapFn:void 0,target:s,type:r,listener:i},u=v.bind(a);return u.listener=i,a.wrapFn=u,u}o.prototype.once=function(r,i){return f(i),this.on(r,w(this,r,i)),this},o.prototype.prependOnceListener=function(r,i){return f(i),this.prependListener(r,w(this,r,i)),this},o.prototype.removeListener=function(r,i){var a,u,g,p,_;if(f(i),u=this._events,u===void 0)return this;if(a=u[r],a===void 0)return this;if(a===i||a.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete u[r],u.removeListener&&this.emit("removeListener",r,a.listener||i));else if(typeof a!="function"){for(g=-1,p=a.length-1;p>=0;p--)if(a[p]===i||a[p].listener===i){_=a[p].listener,g=p;break}if(g<0)return this;g===0?a.shift():E(a,g),a.length===1&&(u[r]=a[0]),u.removeListener!==void 0&&this.emit("removeListener",r,_||i)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(r){var i,a,u;if(a=this._events,a===void 0)return this;if(a.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):a[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete a[r]),this;if(arguments.length===0){var g=Object.keys(a),p;for(u=0;u<g.length;++u)p=g[u],p!=="removeListener"&&this.removeAllListeners(p);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=a[r],typeof i=="function")this.removeListener(r,i);else if(i!==void 0)for(u=i.length-1;u>=0;u--)this.removeListener(r,i[u]);return this};function b(s,r,i){var a=s._events;if(a===void 0)return[];var u=a[r];return u===void 0?[]:typeof u=="function"?i?[u.listener||u]:[u]:i?O(u):k(u,u.length)}o.prototype.listeners=function(r){return b(this,r,!0)},o.prototype.rawListeners=function(r){return b(this,r,!1)},o.listenerCount=function(s,r){return typeof s.listenerCount=="function"?s.listenerCount(r):m.call(s,r)},o.prototype.listenerCount=m;function m(s){var r=this._events;if(r!==void 0){var i=r[s];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function k(s,r){for(var i=new Array(r),a=0;a<r;++a)i[a]=s[a];return i}function E(s,r){for(;r+1<s.length;r++)s[r]=s[r+1];s.pop()}function O(s){for(var r=new Array(s.length),i=0;i<r.length;++i)r[i]=s[i].listener||s[i];return r}function S(s,r){return new Promise(function(i,a){function u(p){s.removeListener(r,g),a(p)}function g(){typeof s.removeListener=="function"&&s.removeListener("error",u),i([].slice.call(arguments))}I(s,r,g,{once:!0}),r!=="error"&&x(s,u,{once:!0})})}function x(s,r,i){typeof s.on=="function"&&I(s,"error",r,i)}function I(s,r,i,a){if(typeof s.on=="function")a.once?s.once(r,i):s.on(r,i);else if(typeof s.addEventListener=="function")s.addEventListener(r,function u(g){a.once&&s.removeEventListener(r,u),i(g)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof s)}return P.exports}var re=ne();class se{emitter;channelHandlers=new Map;constructor(){this.emitter=new re.EventEmitter}subscribe(e,t){this.channelHandlers.has(e)||this.channelHandlers.set(e,new Set),this.channelHandlers.get(e).add(t),this.emitter.on(e,t),console.log(`[RealtimeMock] Subscribed to ${e}`)}publish(e,t){const n=Math.floor(Math.random()*50);setTimeout(()=>{this.emitter.emit(e,t),console.log(`[RealtimeMock] Published to ${e} with ${n}ms latency`,t)},n)}unsubscribe(e,t){const n=this.channelHandlers.get(e);n&&(n.delete(t),this.emitter.off(e,t))}send(e,t){return this.publish(e,t)}connect(){return console.log("[RealtimeMock] Connected (Simulated)"),this}}const oe=[{id:"gold_100",name:"100 Reddit Gold",price_gold:100,stock:999,sold_out:!1},{id:"gold_500",name:"500 Reddit Gold",price_gold:450,stock:100,sold_out:!1},{id:"custom_avatar_rare",name:"Ultra Rare Avatar",price_gold:500,stock:5,sold_out:!1}],ie={Timers:{cooldownMs:5e3,respawnMs:3e3},Limits:{maxDailyPixels:100,maxStackSize:5}},ae={Animations:{placePixelDuration:300,overlayFadeIn:150,easing:"cubic-bezier(0.4, 0, 0.2, 1)"},Colors:{primary:"#FF4500",secondary:"#0079D3",error:"#FF0000",success:"#00BA7C",canvasBackground:"#FFFFFF"}},ce={Onboarding:{welcomeTitle:"Welcome to Pixel Placer",welcomeBody:"Place pixels and create art together!"},Errors:{cooldown:"You are doing that too much. Take a break!",soldOut:"Sorry, we are all out of pixels."},Buttons:{place:"Place Pixel",buy:"Get More"}},le={Gameplay:ie,Visuals:ae,Copy:ce};class ue{userId;subredditId;bucketId;reddit;redis;realtime;kv;media;ui;config;_state;economy;constructor(e={}){this.userId=e.userId||"t2_user123",this.subredditId=e.subredditId||"t5_sub456",this.bucketId=e.bucketId||(Math.random()>.5?"treatment":"control"),this.config=le,this.economy=new te(e.initialProducts||oe),this.reddit=this._mockReddit(),this.redis=this._mockRedis(),this.realtime=new se,this.kv=this._mockKV(),this.media=this._mockMedia(),this._state=new Map,this.ui=this._mockUI()}getBucket(){return this.bucketId}useState(e){const t=JSON.stringify(e);return this._state.has(t)||this._state.set(t,e),[this._state.get(t),n=>{const c=this._state.get(t),o=typeof n=="function"?n(c):n;this._state.set(t,o)}]}_mockReddit(){return{getCurrentUser:async()=>({id:this.userId,name:"dummy_user"}),getSubredditById:async e=>({id:e,name:"test_sub"}),getCurrentSubreddit:async()=>({id:this.subredditId,name:"test_sub"}),getProducts:async()=>this.economy.getProducts(),pay:async e=>{const t=this.economy.getProduct(e.productId),n=this.economy.purchase(e.productId);return console.log(`[MockEconomy] Triggering Modal for ${t?.name||e.productId}`),n.success?{status:"success"}:{status:"failed",reason:n.reason}}}}_mockRedis(){const e=new Map,t=typeof process<"u"&&process.versions!=null&&process.versions.node!=null,n=".dolores_redis_dump.json",c="dolores_redis_dump";if(t)try{const l=require("fs");if(l.existsSync(n)){const f=JSON.parse(l.readFileSync(n,"utf-8"));Object.entries(f).forEach(([h,y])=>e.set(h,y)),console.log("[MockRedis] Loaded persistent state from disk.")}}catch(l){console.warn("[MockRedis] Failed to load persistent state:",l)}else if(typeof localStorage<"u")try{const l=localStorage.getItem(c);if(l){const f=JSON.parse(l);Object.entries(f).forEach(([h,y])=>e.set(h,y)),console.log("[MockRedis] Loaded persistent state from localStorage.")}}catch(l){console.warn("[MockRedis] Failed to load localStorage:",l)}const o=()=>{const l=Object.fromEntries(e),f=JSON.stringify(l,null,2);if(t)try{require("fs").writeFileSync(n,f)}catch(h){console.error("[MockRedis] Persistence failed:",h)}else typeof localStorage<"u"&&localStorage.setItem(c,f)};return{get:async l=>e.get(l),set:async(l,f)=>{e.set(l,f),o()},del:async l=>{e.delete(l),o()},hGet:async(l,f)=>(e.get(l)||{})[f],hSet:async(l,f,h)=>{const y=e.get(l)||{};y[f]=h,e.set(l,y),o()}}}_mockKV(){const e=new Map;return{get:async t=>e.get(t),put:async(t,n)=>{e.set(t,n)},delete:async t=>{e.delete(t)},list:async()=>Array.from(e.keys())}}_mockMedia(){return{upload:async e=>({id:`media_${Math.random().toString(36).substr(2,9)}`,url:e}),getMediaById:async e=>({id:e,url:`https://mock.reddit.com/${e}.jpg`})}}_mockUI(){return{showToast:e=>{console.log(`[MockUI] Toast: ${typeof e=="string"?e:e.text}`)},navigateTo:e=>{console.log(`[MockUI] Navigating to: ${e}`)},showForm:e=>(console.log(`[MockUI] Showing form: ${e}`),Promise.resolve({values:{}}))}}}class de{si;userId;startTime;totalActiveTime=0;lastVisibleStart;constructor(e,t="anon"){this.si=e,this.userId=t,this.startTime=Date.now(),this.lastVisibleStart=Date.now(),typeof document<"u"&&this.attach()}attach(){document.addEventListener("visibilitychange",()=>{if(document.hidden){const e=Date.now()-this.lastVisibleStart;this.totalActiveTime+=e,this.si.capture("session_visibility_hidden",this.userId,{active_segment_ms:e,total_active_ms:this.totalActiveTime})}else this.lastVisibleStart=Date.now(),this.si.capture("session_visibility_visible",this.userId,{})}),window.addEventListener("beforeunload",()=>{const e=Date.now()-this.lastVisibleStart;document.hidden||(this.totalActiveTime+=e),this.si.capture("session_end",this.userId,{total_duration_ms:Date.now()-this.startTime,total_active_ms:this.totalActiveTime})})}}class A{events=[];capture(e,t,n={}){const c={event_type:e,user_id:t,timestamp:Date.now(),payload:n};return this.events.push(c),console.log(`[SignalIntegrity] Captured ${e} for ${t}`,n),c}detectRageClicks(e,t=3,n=1e3){return e.length<t?!1:e.filter(o=>Date.now()-o<n).length>=t}simulateThetaSketch(e){const n=new Set(e).size;return{estimate:n,lowerBound:Math.floor(n*.98),upperBound:Math.ceil(n*1.02)}}getEvents(){return[...this.events]}clear(){this.events=[]}}const fe=Object.freeze(Object.defineProperty({__proto__:null,SessionTracker:de,SignalIntegrity:A},Symbol.toStringTag,{value:"Module"}));class pe{container=null;signalIntegrity;mockContext;constructor(e,t){this.signalIntegrity=e,this.mockContext=t}mount(e=document.body){this.container=document.createElement("div"),this.container.id="dolores-debug-overlay",this.applyStyles(),e.appendChild(this.container),this.render(),setInterval(()=>this.render(),1e3)}applyStyles(){this.container&&Object.assign(this.container.style,{position:"fixed",top:"10px",right:"10px",width:"300px",backgroundColor:"rgba(0, 0, 0, 0.85)",color:"#00ff00",fontFamily:"monospace",padding:"10px",borderRadius:"8px",zIndex:"10000",fontSize:"12px",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",maxHeight:"80vh",overflowY:"auto"})}render(){if(typeof document>"u"){console.log("[DebugOverlay] Virtual Render: Metrics Updated");return}if(!this.container)return;const e=this.signalIntegrity.getEvents(),t=e.filter(n=>n.event_type==="rage_click").length;this.container.innerHTML=`
      <div style="border-bottom: 1px solid #333; padding-bottom: 5px; margin-bottom: 10px; font-weight: bold;">
        PROJECT DOLORES DEBUG
      </div>
      <div>
        <strong>Recent Signals:</strong>
        <ul style="list-style: none; padding: 0; margin-top: 5px;">
          ${e.slice(-5).reverse().map(n=>`
            <li style="margin-bottom: 4px; border-left: 2px solid #00aa00; padding-left: 5px;">
              [${new Date(n.timestamp).toLocaleTimeString()}] ${n.event_type}
            </li>
          `).join("")}
        </ul>
      </div>
      <div style="margin-top: 10px; padding-top: 5px; border-top: 1px solid #333;">
        <strong>Metrics:</strong><br/>
        Rage Clicks: <span style="color: ${t>0?"#ff4444":"#00ff00"}">${t}</span><br/>
        Est. Unique Users: ${this.signalIntegrity.simulateThetaSketch(e.map(n=>n.user_id)).estimate}<br/>
        <strong>Bucket:</strong> <span style="color: #00ffff">${this.mockContext.getBucket()}</span>
      </div>
    `}}class he{context;si;productId;container=null;constructor(e,t,n="gold_100"){this.context=e,this.si=t,this.productId=n}async render(e=null){if(typeof document>"u"){console.log(`[GoldGate] Virtual Render: Discovered Product ${this.productId}`);return}const t=e||document.body,n=this.context.getBucket(),o=(await this.context.reddit.getProducts()).find(f=>f.id===this.productId);if(!o){console.error(`[GoldGate] Product ${this.productId} not found`);return}const l=n==="treatment"?Math.floor(o.price_gold*.8):o.price_gold;this.container=document.createElement("div"),this.container.id="gold-gate-container",this.applyStyles(),this.container.innerHTML=`
      <div style="background: #1a1a1b; color: #d7dadc; padding: 20px; border-radius: 8px; border: 1px solid #343536; text-align: center; width: 350px;">
        <h3 style="margin-top: 0; color: #ffd700;">Exclusive Offer</h3>
        <p style="font-size: 14px;">Get <strong>${o.name}</strong> to unlock premium features.</p>
        <div style="margin: 20px 0;">
          <span style="font-size: 24px; font-weight: bold; color: ${n==="treatment"?"#44ff44":"#ffffff"}">
            ${l} Gold
          </span>
          ${n==="treatment"?`<br/><small style="text-decoration: line-through; opacity: 0.6;">${o.price_gold} Gold</small>`:""}
        </div>
        <button id="gold-gate-buy-btn" style="background: #ff4500; color: white; border: none; padding: 12px 24px; border-radius: 999px; cursor: pointer; font-weight: bold; width: 100%;">
          Purchase Now
        </button>
        <p style="font-size: 10px; margin-top: 10px; opacity: 0.5;">Experiment Bucket: ${n}</p>
      </div>
    `,t.appendChild(this.container),document.getElementById("gold-gate-buy-btn")?.addEventListener("click",async()=>{this.si.capture("gold_gate_click","user_id",{bucket:n,price:l});const f=await this.context.reddit.pay({productId:this.productId});f.status==="success"?(this.si.capture("gold_gate_purchase_success","user_id",{bucket:n}),alert("Purchase successful!")):(this.si.capture("gold_gate_purchase_failed","user_id",{bucket:n,reason:f.reason}),alert(`Purchase failed: ${f.reason}`))}),this.si.capture("gold_gate_impression","user_id",{bucket:n,price:l})}applyStyles(){this.container&&Object.assign(this.container.style,{position:"fixed",bottom:"100px",right:"20px",zIndex:"9999",fontFamily:"sans-serif"})}}class me{config;container=null;constructor(e){this.config=e}renderData(e,t=0){if(typeof document>"u")return"";let n=`<ul style="list-style: none; padding-left: ${t*15}px;">`;for(const c in e){const o=e[c],l=typeof o=="object"&&o!==null;n+='<li style="margin-bottom: 5px;">',l?(n+=`<div style="font-weight: bold; cursor: pointer;">▶ ${c}</div>`,n+=this.renderData(o,t+1)):n+=`
          <div style="display: flex; justify-content: space-between; width: 200px;">
            <span style="opacity: 0.8;">${c}:</span>
            <input type="text" value="${o}" style="width: 80px; background: #333; color: white; border: none;" />
          </div>
        `,n+="</li>"}return n+="</ul>",n}renderCLI(e=this.config,t=""){let n="";const c=Object.entries(e);return c.forEach(([o,l],f)=>{const h=f===c.length-1,y=h?"└── ":"├── ",v=t+(h?"    ":"│   ");typeof l=="object"&&l!==null?(n+=`${t}${y}${o}
`,n+=this.renderCLI(l,v)):n+=`${t}${y}${o}: ${l}
`}),n}}class ge{constructor(e){this.width=10,this.height=10,this.context=e}async setPixel(e,t,n){if(e<0||e>=this.width||t<0||t>=this.height)throw new Error("Coordinates out of bounds");const c=`pixel:${e}:${t}`;await this.context.redis.set(c,n),this.context.realtime.send("board_update",{x:e,y:t,color:n}),console.log(`[PixelBoard] Set pixel (${e}, ${t}) to ${n}`)}async getBoard(){const e=Array(this.height).fill(null).map(()=>Array(this.width).fill("#ffffff"));for(let t=0;t<this.height;t++)for(let n=0;n<this.width;n++){const c=await this.context.redis.get(`pixel:${n}:${t}`);c&&(e[t][n]=c)}return e}}if(typeof document<"u"){const d=document.getElementById("status-bar");d&&(d.innerText="Initializing scripts..."),window.onerror=(e,t,n,c,o)=>(d&&(d.innerText=`CRITICAL ERROR: ${e}
Line: ${n}`,d.style.color="red"),!1)}const ye=async()=>{const d=document.getElementById("status-bar"),e=m=>{console.log(m),d&&(d.innerText=m)};e("Step 1: Imports loaded. Initializing Context..."),await new Promise(m=>setTimeout(m,100));const t=new ue({userId:"t2_browser_user",bucketId:"treatment"});e("Step 2: Context ready. Initializing SignalIntegrity..."),await new Promise(m=>setTimeout(m,100));const n=new A;new(await U(async()=>{const{SessionTracker:m}=await Promise.resolve().then(()=>fe);return{SessionTracker:m}},void 0)).SessionTracker(n,"t2_browser_user"),e("Step 3: App components initializing..."),await new Promise(m=>setTimeout(m,100));const c=new ge(t),o=new pe(n,t),l=new me(t.config);e("Step 4: Rendering UI...");const f=document.getElementById("config-menu-container");f&&(f.innerHTML="<h3>Vibe Coding Menu</h3>"+l.renderData(t.config)),o.mount(),setInterval(()=>o.render(),1e3);const h=document.getElementById("game-container"),y=document.getElementById("status-bar");if(!h)return;const v=10;h.style.gridTemplateColumns=`repeat(${v}, 1fr)`;const w=async()=>{const m=await c.getBoard();h.innerHTML="",m.forEach((k,E)=>{k.forEach((O,S)=>{const x=document.createElement("div");x.className="pixel",x.style.backgroundColor=O,x.title=`(${S}, ${E})`,x.onclick=async()=>{try{const I=t.config.Visuals?.Animations?.placePixelDuration||300;x.style.transition=`transform ${I}ms`,x.style.transform="scale(0.5)",await c.setPixel(S,E,t.config.Visuals?.Colors?.primary||"#FF4500"),n.capture("pixel_place","t2_browser_user",{x:S,y:E});const s=Date.now();window.lastClickTimes||(window.lastClickTimes=[]),window.lastClickTimes.push(s),window.lastClickTimes=window.lastClickTimes.filter(r=>s-r<1e3),window.lastClickTimes.length>=5&&(console.warn("[Rage Click] Detected!"),n.capture("rage_click","t2_browser_user",{x:S,y:E,count:window.lastClickTimes.length}),h.style.transform=`translate(${Math.random()*4-2}px, ${Math.random()*4-2}px)`,setTimeout(()=>h.style.transform="none",100),window.lastClickTimes=[]),setTimeout(()=>x.style.transform="scale(1)",100)}catch(I){console.error(I)}},h.appendChild(x)})})};t.realtime.connect().subscribe("board_update",m=>{console.log("[Realtime] Board updated",m),w()}),await w(),y&&(y.innerText="Connected. Place a pixel!");const b=document.createElement("button");b.innerText="Buy Premium Palette",b.style.marginTop="20px",b.style.padding="10px 20px",b.onclick=async()=>{new he(t,n,"custom_avatar_rare").render()},document.body.appendChild(b)};ye().catch(d=>{console.error(d);const e=document.getElementById("status-bar");e&&(e.innerText=`Error: ${d.message}`,e.style.color="red")});
